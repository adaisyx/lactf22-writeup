## Switcheroo

#### TL;DR
Program likely written in assembly that does a bunch of math. Brute force was used to find characters that satisfied the condition in order to obtain the flag. 

#### Disassembly
The program contains 2 main bits: the code bit with all the instructions, and a part with all the bytes required for the logic. 
```asm
 4119: entry0 ();
│           0x00401000      488d34250020.  lea rsi, str.Give_me_the_flag:_That_was_not_the_flag_:_That_was_the_flag_ ; [02] -r-x section size 194 named .text
│           0x00401008      bf01000000     mov edi, 1
│           0x0040100d      ba12000000     mov edx, 0x12               ; 18
│           0x00401012      b801000000     mov eax, 1
│           0x00401017      0f05           syscall
│           0x00401019      31ff           xor edi, edi
│           0x0040101b      4889e6         mov rsi, rsp
│           0x0040101e      ba64000000     mov edx, 0x64               ; 'd' ; 100
│           0x00401023      31c0           xor eax, eax
│           0x00401025      0f05           syscall
│           0x00401027      4883f840       cmp rax, 0x40               ; elf_phdr
│       ┌─< 0x0040102b      755e           jne 0x40108b
│       │   0x0040102d      4d31e4         xor r12, r12
│       │   0x00401030      4c8d1c253c20.  lea r11, [0x40203c]
│       │   0x00401038      4d31d2         xor r10, r10
│       │   ; CODE XREF from entry0 @ 0x401071
│      ┌──> 0x0040103b      4939c2         cmp r10, rax
│     ┌───< 0x0040103e      7d33           jge 0x401073
│     │╎│   0x00401040      4e0fb60c14     movzx r9, byte [rsp + r10]
│     │╎│   0x00401045      4e8b04cd3c20.  mov r8, qword [r9*8 + 0x40203c]
│     │╎│   0x0040104d      49c1c008       rol r8, 8
│     │╎│   0x00401051      4d0fb6e8       movzx r13, r8b
│     │╎│   0x00401055      4d31f6         xor r14, r14
│     │╎│   ; CODE XREF from entry0 @ 0x401069
│    ┌────> 0x00401058      4d39ee         cmp r14, r13
│   ┌─────< 0x0040105b      7d0e           jge 0x40106b
│   │╎│╎│   0x0040105d      49c1c008       rol r8, 8
│   │╎│╎│   0x00401061      4538d0         cmp r8b, r10b
│  ┌──────< 0x00401064      7408           je 0x40106e
│  ││╎│╎│   0x00401066      49ffc6         inc r14
│  ││└────< 0x00401069      ebed           jmp 0x401058
│  │└─────> 0x0040106b      49ffc4         inc r12
│  └──────> 0x0040106e      49ffc2         inc r10
│     │└──< 0x00401071      ebc8           jmp 0x40103b
│     └───> 0x00401073      4d85e4         test r12, r12
│      ┌──< 0x00401076      7513           jne 0x40108b
│     ┌───< 0x00401078      eb02           jmp 0x40107c
..
│    ││││   ; CODE XREF from entry0 @ 0x401078
│    └└───> 0x0040107c      488d34252a20.  lea rsi, [0x40202a]
│      ││   0x00401084      ba12000000     mov edx, 0x12               ; 18
│     ┌───< 0x00401089      eb0f           jmp 0x40109a
│     │└└─> 0x0040108b      488d34251220.  lea rsi, [0x402012]
│     │     0x00401093      ba18000000     mov edx, 0x18               ; 24
│     │ ┌─< 0x00401098      eb00           jmp 0x40109a
│     │ │   ; CODE XREFS from entry0 @ 0x401089, 0x401098
│     └─└─> 0x0040109a      bf01000000     mov edi, 1
│           0x0040109f      b801000000     mov eax, 1
│           0x004010a4      0f05           syscall
│           0x004010a6      6a0a           push 0xa                    ; 10
│           0x004010a8      4889e6         mov rsi, rsp
│           0x004010ab      ba01000000     mov edx, 1
│           0x004010b0      b801000000     mov eax, 1
│           0x004010b5      0f05           syscall
│           0x004010b7      31ff           xor edi, edi
│           0x004010b9      48c7c03c0000.  mov rax, 0x3c               ; '<' ; 60
│           0x004010c0      0f05           syscall
```

Basically what the binary does is that it does a syscall to read input from the user. It then loops through each character of the user's input, and based on the input, takes a 8 byte thing as a "key". It then performs mathematical operations on the key, and compares if the last byte of the key at the end of all the operations is equal to the count. This has been reimplemented in my python solve script: 

```python
INT_BITS = 64
def rol(n, d): ## rotate n by d bits
    return (n << d)|(n >> (INT_BITS - d))
    
def byte_proc(n): ## takes in int input
        bla = hex(n)
        if "x" not in bla[-16:]:
                bla_want = bla[-16:]
                bla_no = int(bla_want, 16)
                return bla_no
        else:
                return n

dump = b"\x06\x05\x04\x03\x02\x01\x00\x07\x7e\xfc\x3c\x78\xfb\xf4\x04\x3e\x03\x87\x30\x04\x3d\x81\x70\x9d\x4d\xa7\x3d\x09\xf8\xa1\x51\x4a\xfc\x02\x8b\xa8\xb2\x50\x49\x0c\x4b\xfd\xf0\x62\x92\x1d\xd2\x02\xa9\x46\xbe\xaa\xbe\x81\xe7\x88\x94\x19\xbb\x85\x0e\x0f\x09\x77\xfb\x49\x3f\x35\x24\xb8\x4e\x56\x47\x9b\x62\xeb\x9d\x7a\x0b\x7f\xd1\x18\x6e\x14\x30\xb1\x3f\x01\xed\x65\xd4\x4d\x7e\xe1\x50\xe6\xe7\xab\x3d\x80\x04\x67\xd3\x81\x7a\x8c\x71\x73\xa3\x80\xce\x02\x73\x48\x25\x30\x09\x51\x2c\x82\x4e\x68\x70\x50\x47\x37\x08\x57\xb5\x14\x10\x32\xec\x34\xd7\x3b\xb3\x98\xdd\x7e\xe3\x1e\x5e\x97\xfd\x4c\x0d\xb6\xfe\x44\x81\x15\x91\x42\x15\xac\x6c\x7c\x40\x88\x1b\xfc\x0d\x92\x2b\x19\xae\x0f\x80\x26\x76\x7c\x6e\x67\x0c\xfc\x27\xef\x94\x6d\xd3\xb8\x50\x48\xa2\x4d\x88\x0d\x72\x66\x64\x08\xdc\x48\x4f\xc1\x53\x04\x7e\xac\xd8\xdf\x61\x24\xad\x68\x25\x7c\x08\x1f\x91\xde\x5d\x06\x3b\x47\x71\x58\xe6\x42\xd7\x1f\xed\x1e\x48\x25\xb8\xc1\xc3\xed\x81\x6c\xff\x02\x18\xb6\x71\x9f\x16\x03\xe0\x3f\xae\x92\x67\x39\xa7\xe4\xca\xb7\x10\x6b\xac\x08\xcf\x90\xa0\x81\xf0\x31\x09\xa1\x4c\x00\x3b\x68\x89\x8f\xf1\x3d\xf5\x00\x49\x8f\xde\xb1\xbc\x42\x42\x00\xca\x84\xac\xce\x00\x59\x7e\x00\xa4\x0e\x11\xe8\x0f\x6f\x70\x00\x4e\x50\x62\x20\xb4\x78\x22\x00\x9c\x2b\xa5\x5d\xa9\x05\x2a\x00\x49\x0e\xdf\xb9\xd0\xc5\x4d\x00\xc4\xf0\x6c\xe0\x41\x36\x6c\x00\x6e\x4a\x37\x8e\xa6\x47\x79\x00\x02\x68\x33\x2b\x63\xd2\xd8\x00\x2e\x02\xb5\x2f\xc4\x56\x38\x01\x18\x39\x08\x1a\xdb\x14\x3b\x00\xbb\xe1\x2f\xb1\x3a\x67\xf8\x00\x24\x12\xed\x14\xb0\x08\xa1\x00\x04\x3b\xef\x6a\x2e\x89\xb2\x00\xd6\x24\x00\x18\xd3\x3c\x2c\x02\x34\x5f\xfc\xd0\xaa\x11\x39\x02\xe6\x4e\x4b\x71\xc9\x07\x08\x02\x27\x23\x30\x09\x1c\x33\x1a\x07\x45\xd2\xa9\x21\x29\x06\x18\x04\x53\x92\x0f\x2b\x34\x16\x1f\x05\x7c\xe9\x0a\xda\xbf\x19\x3b\x01\x1e\x2f\x19\x35\x25\x17\x12\x07\x95\xd2\x10\xc9\x0b\x2a\x32\x03\x94\x63\x19\xfa\xff\x70\xc0\x00\xdd\x99\x49\xa8\x72\xb0\x9a\x00\xac\xaa\xa1\x74\xe1\x82\x4e\x00\xb9\x84\x95\x41\x05\x52\xaa\x00\xd5\xe3\x1e\x8c\x2b\x8a\x67\x00\xd0\xe7\xd8\xc9\xac\xbc\x45\x00\xf9\xd4\xb0\x84\xc3\x19\x3a\x00\x1b\xc5\x82\xa5\x60\x19\x8b\x00\xcd\x2a\x2a\x6c\x50\xc4\x4e\x00\xe1\x86\x57\x60\xc8\x73\x74\x00\x7f\xb3\xba\x6b\x53\x16\x13\x01\xef\xde\xdb\x7f\x24\x0d\x0f\x00\x76\x1e\xde\xa9\x08\xf6\xad\x00\xe3\x82\xcf\x68\x08\x54\x9f\x00\x1d\x80\x2b\x31\xfc\xf5\x14\x00\xfe\x24\x32\xc4\x14\x6f\x10\x00\xc5\x37\x8b\x5d\xad\x5b\xb8\x00\x0d\x99\x8c\x84\x17\xce\xed\x00\xc4\xbc\x11\xdf\x13\xdc\xcc\x00\x9b\x55\xa0\x76\x67\x2d\x0c\x02\xf7\x21\x75\xea\x64\x1b\x0a\x02\x82\xbe\x90\xd9\x24\x1d\x39\x00\xa8\x3c\xd7\x9d\x71\x00\x75\x00\x37\x2a\xa8\xb2\xad\x2e\xef\x00\x60\x14\x96\x40\x0a\xf1\x8e\x00\xa5\x67\x3f\xfe\x2c\x9a\x33\x00\x9d\x87\x65\x63\x30\x71\xe0\x00\xf0\xdc\x75\x2a\x3d\x6e\x6e\x00\xf0\x73\x82\xc1\x54\x72\x2e\x01\x7f\x66\x9b\xcd\xad\x08\x48\x00\x95\x63\xea\x30\x12\x80\x10\x01\x38\xfc\xf1\xf1\xc7\x98\xfa\x00\xd9\x7b\xfe\xe6\x0f\x40\x0d\x01\x4d\xb9\x08\x00\x15\x9e\x47\x00\x95\x48\x13\x38\xcf\x80\xf9\x00\xac\x5d\xcb\x7b\xfe\x0f\x2a\x00\x99\x9b\xce\x0f\x4b\x0b\x75\x00\x58\x77\xb3\x79\xfe\x6e\xbd\x00\x28\x36\x15\x31\x24\x0e\x20\x07\x02\xbc\x32\x40\xf1\xaa\x7c\x00\xbb\x95\x83\x61\x1f\x01\x3d\x02\x9e\x6f\xfe\x34\x78\x80\x53\x00\xc8\x70\x86\xe8\x3d\x30\x02\x01\xf8\xd8\x08\xc7\x3a\x0c\xf5\x00\xbc\x75\x9d\xa9\xf8\x5e\xff\x00\x7e\x51\x0e\x10\x12\x3a\x04\x02\x06\xd7\x49\xd0\x19\x2d\xe8\x00\x14\x42\x62\xdb\x31\x26\x14\x02\x0b\xa6\xff\xb0\x63\x13\xa9\x00\xf9\xb2\x7d\x13\xa1\x8e\x85\x00\xec\x18\xb0\x06\xfa\x4f\x6f\x00\x34\xf0\x80\x76\xe7\x57\x00\x01\x72\x72\x8c\x8b\xb8\x5a\x5a\x00\x82\x1d\x08\x34\x68\x19\x1d\x01\xac\xea\xfa\x56\x07\xee\x6d\x00\x78\x00\x16\x0c\xe8\x61\x16\x00\x13\xc3\x58\x1a\x7a\xa6\xcc\x00\xe8\x13\x1b\xb8\x83\x36\x22\x01\x8d\xd6\x45\x03\xc2\xca\x65\x00\xdc\xec\x50\x60\x1a\x1c\x03\x01\x05\x19\x2c\x97\xec\x04\x37\x01\x25\x0b\x6c\x8b\xe4\xc9\x4e\x00\xdd\xe1\xa5\x12\x0d\xc4\x55\x00\x0e\xe4\x20\xc4\xfc\xd4\xf0\x00\xf3\x27\x8b\x99\xc1\xb8\x9b\x00\xf6\x1a\x04\x04\x5d\xc8\xca\x00\x05\xba\x8e\x89\xaf\x41\x05\x02\x95\x10\x67\x3d\x26\xb0\x2c\x00\x43\x36\xac\xe7\xff\x42\x3e\x02\x87\x60\x09\x4e\x62\xf3\x19\x00\xec\x88\xa7\x5a\x99\xd3\xf8\x26"

soln = [None] * 0x40

for sol in range(len(soln)): 
	soln[sol] = []

for count in range(0x40):
	print("count: " + str(count))
	i = 0x21 
	while i < 0x7f: 
		#print(chr(i))
		addr = i * 8
		ad = 7
		target = ""
		while ad >= 0: ## putting together target
			pre = hex(dump[addr+ad])[2:]
			target = target + pre.rjust(2,"0")
			ad = ad - 1
		i = i + 1
		r14 = 0
		target = int(target, 16))
		target = rol(target, 8)
		target = byte_proc(target)
		target_lb_orig = hex(target)[-2:]
		while int(target_lb_orig,16) >= r14:
			target = rol(target, 8)
			target = byte_proc(target)
			target_lb = hex(target)[-2:]
			if int(target_lb, 16) == count:
				soln[count].append(chr(i-1))
				break
			else:
				r14 = r14 + 1
		
print(soln)
#print(soln[2][0])

stuff = []

for x in range(0x40-1):
	stuff.append(soln[x][0])

print("".join(stuff))
```

The script brute forces every possible printable ascii character for every character of the flag. 

The flag is lactf{4223M8LY_5W17Ch_57473M3n75_4r3_7h3_4850LU73_8357_u+1f60a}. 
